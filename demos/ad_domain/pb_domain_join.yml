---
- name: Join Domain
  hosts: domain_ou_computers 
  become: false
  gather_facts: false

  vars:
    ansible_user: ec2-user
    ansible_password: "{{ ec2_admin_password }}"
    ansible_winrm_transport: credssp

  vars_files:
    - vars/join_domain.yml
    - vars/secrets.yml

  tasks:
    - name: Join new windows hosts to domain 
      ansible.builtin.include_tasks:
        file: tasks/join_domain.yml
